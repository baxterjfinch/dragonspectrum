<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/html">

<head>
    <title>thinkTank</title>
    {% include 'head_links.html' %}
    {% include "_firebase_config.html" %}
    <link href="/css/summernote.css" rel="stylesheet">
    <link href="//cdnjs.cloudflare.com/ajax/libs/x-editable/1.5.0/bootstrap3-editable/css/bootstrap-editable.css" rel="stylesheet"/>
</head>

<body>
<div id="nav_bar">
    <div id="notification" class='notifications bottom-right'></div>
    <nav class="navbar navbar-inverse" role="navigation">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse-item">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a id="tt-home" class="navbar-brand" href="/">thinkTank</a>
        </div>

        <div id="navbar-collapse-menus" class="collapse navbar-collapse navbar-collapse-item">
            <ul class="nav navbar-nav">
                <li id="project-menu-item">
                    <a id="project_dropdown" class="dropdown-toggle" data-toggle="dropdown" role="button" href="#">
                        Project
                        <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="project_dropdown">
                        <li><a id="nar_bar_create_project" href="#"><i class="fa fa-plus"></i> New Project <kbd class="shortcut">CTRL+ALT+N</kbd></a></li>
                        <li><a id="nar_bar_import_project" href="#"><i class="fa fa-upload"></i> Import Project <kbd class="shortcut">CTRL+ALT+I</kbd></a></li>
                        <li class="divider"></li>
                        <li><a id="nar_bar_backup_project" href="#"><i class="fa fa-archive"></i> Backup Project</a></li>
                        <li><a id="nar_bar_restore_project" href="#"><i class="fa fa-file"></i> Restore Project</a></li>
                        <li class="divider"></li>
                        <li><a id="nar_bar_rename_project" href="#"><i class="fa fa-pencil"></i> Rename Project</a></li>
                        <li><a id="nar_bar_delete_project" href="#"><i class="fa fa-times-circle"></i> Delete Project</a></li>
                        <li><a id="nav_bar_project_security" href="#"><i class="fa fa-shield"></i> Project Security</a></li>
                        <li class="divider"></li>
                        <li><a id="nar_bar_exort_abstract" href="#"><i class="fa fa-file-text-o"></i> Generate Abstract/Summary</a></li>
                        <li><a id="nar_bar_exort_presentation" href="#"><i class="fa fa-file-powerpoint-o"></i> Generate Presentation</a></li>
                        <li class="divider"></li>
                        <li><a id="nar_bar_exort_print" href="#"><i class="fa fa-print"></i> Print <kbd class="shortcut">CTRL+P</kbd></a></li>
                    </ul>
                </li>
                <li id="document-menu-item">
                    <a id="document_dropdown" class="dropdown-toggle" data-toggle="dropdown" role="button" href="#">
                        Document
                        <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="document_dropdown">
                        <li><a id="nav_bar_create_document" href="#"><i class="fa fa-plus"></i> New Document <kbd class="shortcut">CTRL+ALT+D</kbd></a></li>
                        <li class="divider"></li>
                        <li><a id="nav_bar_edit_document" href="#"><i class="fa fa-pencil"></i> Edit Document Properties</a></li>
                        <li><a id="nav_bar_delete_document" href="#"><i class="fa fa-times-circle"></i> Delete Document</a></li>
                        <li><a id="nav_bar_document_security" href="#"><i class="fa fa-shield"></i> Document Security</a></li>
                    </ul>
                </li>
                <li id="concept-menu-item">
                    <a id="concept_dropdown" class="dropdown-toggle" data-toggle="dropdown" role="button" href="#">
                        Concept
                        <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="concept_dropdown">
                        <li><a id="nav_bar_create_concept" href="#"><i class="fa fa-plus"></i> New Concept <kbd class="shortcut">ENTER</kbd></a></li>
                        <li><a id="nav_bar_create_image_concept" href="#"><i class="fa fa-picture-o"></i> New Image Concept</a></li>
                        <li><a id="nav_bar_create_linked_concept" href="#"><i class="fa fa-link"></i> New Linked Concept</a></li>
                        <li><a id="nav_bar_delete_concept" href="#"><i class="fa fa-times-circle"></i> Delete Concept <kbd class="shortcut">DELETE</kbd></a></li>
                        <li class="divider"></li>
                        <li><a id="nav_bar_concept_security" href="#"><i class="fa fa-shield"></i> Concept Security</a></li>
                        <li><a id="copy_link" class="copy-btn" href="#"><i class="fa fa-link"></i> Copy Concept Link</a></li>
                    </ul>
                </li>
                <li id="phrasing-menu-item">
                    <a id="phrasing_dropdown" class="dropdown-toggle" data-toggle="dropdown" role="button" href="#">
                        Phrasing
                        <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="phrasing_dropdown">
                        <li><a id="nav_bar_create_phrasing" href="#"><i class="fa fa-plus"></i> New Phrasing <kbd class="shortcut">SHIFT+ENTER</kbd></a></li>
                        <li><a id="nav_bar_edit_phrasing" href="#"><i class="fa fa-pencil"></i> Edit Phrasing <kbd class="shortcut">ESCAPE</kbd></a></li>
                    </ul>
                </li>
                <li id="view-menu-item">
                    <a id="view_dropdown" class="dropdown-toggle" data-toggle="dropdown" role="button" href="#">
                        View
                        <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="view_dropdown">
                        <li><a id="nav_bar_toggle_image" href="#"><i class="fa fa-arrows-alt"></i> Toggle Image Display <kbd class="shortcut">CTRL+I</kbd></a></li>
                    </ul>
                </li>
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a id="help_dropdown" class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-life-saver"></i> Help
                        <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a onclick="show_about_dialog()"><i class="fa fa-info-circle"></i> About thinkTankâ„¢</a></li>
                        <li class="divider"></li>
                        <li><a onclick="show_search_help()"><i class="fa fa-search"></i> Help with Search</a></li>
                        <li><a href="https://www.youtube.com/watch?v=UPuJRQBaO7M&list=PLMhWFDh_vyK63O70qwGOJw8L3IfvFL9P_" target="tutorials"><i class="fa fa-youtube-play"></i> Tutorial Videos</a></li>
                        <li><a href="https://thinktank.corpus.io/project/338f60a8da9a11e38c358be5c980dc22?doc=338f3994da9a11e38c358be5c980dc22&nav=true" target="user-guide"><i class="fa fa-question-circle"></i> User Guide</a></li>
                        <li><a onclick="play_guided_tour()"><i class="fa fa-road"></i> Take a Quick Guided Tour</a></li>
                        <li class="divider"></li>
                        <li><a onclick="show_keybindings()"><i class="fa fa-keyboard-o"></i> Shortcuts <kbd class="shortcut">CTRL+K</kbd></a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a id="user_dropdown" class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-user"></i> {{ display_name }} <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a id="nar_bar_user" href="#"><i class="fa fa-user"></i> My Profile</a></li>
                        <li><a id="nar_bar_user_admin" href="#">Admin Panel</a></li>
                        <li class="divider"></li>
                        <li><a id="nar_bar_user_logout" href="#"><i class="fa fa-sign-out"></i> Log Out</a></li>
                    </ul>
                </li>
            </ul>
            <div id="search-form" class="nav navbar-nav navbar-right col-sm-5 col-md-4 col-lg-3">
                <form class="navbar-form navbar-right" role="search">
                    <div class="form-group">
                        <div class="input-group input-group-sm">
                            <input type="text" class="form-control" placeholder="Search" id="search_input">
                            <span class="input-group-addon" id="search_btn"><i class="fa fa-search"></i></span>
                            <span class="input-group-addon" id="clear_search_btn"><strong>X</strong></span>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </nav>
</div>

<!-- container @ full width -->
<div class="container-liquid">

    <div id="content-pane" class="row">

        <!-- TVs -->
        <div id="tvs-wrapper" class="hidden-xs col-sm-4 col-md-3 col-lg-3">
            <div id="tvs" class="well well-small">
                <div id="tvs-toolbar" style="margin-bottom: 2px">
                    <div id="tvs-buttons" class="btn-group">
                        <button type="button" class="btn btn-xs" id="tvs-tool-bar-new" data-toggle="tooltip" data-placement="top" data-container="body" title="New Concept &lt;Enter&gt;"><i class="fa fa-plus"></i></button>
                        <button type="button" class="btn btn-xs" id="tvs-tool-bar-del" data-toggle="tooltip" data-placement="top" data-container="body" title="Delete Concept &lt;Delete&gt;"><i class="fa fa-minus"></i></button>
                        <button type="button" class="btn btn-xs" id="tvs-tool-bar-indent" data-toggle="tooltip" data-placement="top" data-container="body" title="Indent Concept &lt;Tab&gt;"><i class="fa fa-arrow-right"></i></button>
                        <button type="button" class="btn btn-xs" id="tvs-tool-bar-outdent" data-toggle="tooltip" data-placement="top" data-container="body" title="Outdent Concept &lt;Shift-Tab&gt;"><i class="fa fa-arrow-left"></i></button>
                        <button type="button" class="btn btn-xs" id="tvs-tool-bar-move-up" data-toggle="tooltip" data-placement="top" data-container="body" title="Move Concept Up &lt;Ctrl+Up&gt;"><i class="fa fa-arrow-up"></i></button>
                        <button type="button" class="btn btn-xs" id="tvs-tool-bar-move-down" data-toggle="tooltip" data-placement="top" data-container="body" title="Move Concept Down &lt;Ctrl+Down&gt;"><i class="fa fa-arrow-down"></i></button>
                        <button type="button" class="btn btn-xs" id="tvs-tool-bar-expand" data-toggle="tooltip" data-placement="top" data-container="body" title="Expand Children"><i class="fa fa-angle-double-down"></i></button>
                        <button type="button" class="btn btn-xs" id="tvs-tool-bar-collapse" data-toggle="tooltip" data-placement="top" data-container="body" title="Collapse Children"><i class="fa fa-angle-double-up"></i></button>
                        <button type="button" class="btn btn-xs" id="tvs-tool-bar-security" data-toggle="tooltip" data-placement="top" data-container="body" title="Project Security"><i id="project-security-icon" class="fa fa-shield"></i></button>
                    </div>
                </div>
                <div id="scrollbar-tv">
                    <div id="loading_tree_status"></div>
                    <div id="tree"></div>
                </div>
            </div>
        </div>

        <!-- right pane -->
        <div id="right-pane" class="col-xs-12 col-sm-8 col-md-9 col-lg-9">

            <!-- Doc Tabs -->
            <div id="dvs-tabs-container" class="row">
                <div class="col-lg-*">
                    <div id="dvs-tabs" class="tabbable">
                        <ul class="nav nav-tabs" id="document_tab"></ul>
                    </div>
                </div>
            </div>

            <!-- DVs -->
            <div id="dvs" class="row">
                <div class="col-lg-*">
                    <div id="scrollbar-dv" class="dvs">
                        <div id="summary-well" class="well hidden">
                            <h4 id="summary-heading">Summary</h4>
                            <span> <span id="summary-current-word-count">0</span> of <span id="summary-word-count">250</span> words</span>
                            <span id="summary-progress" class="color-pulse"> Loading, Please wait... <i class="fa fa-spinner fa-spin"></i></span>
                            <div id="summary-slider" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all">
                                <span id="summary-slider-handle" class="slider-handle ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 20%;"></span>
                                <div id="summary-slider-progress"></div>
                            </div>
                            <div id="summary-btn">
                                <!--<button id="summary-copy-btn" class="btn btn-default btn-xs summary-btn">Copy</button>-->
{#                                <button class="btn btn-default btn-xs summary-btn">Share</button>#}
                            </div>
                        </div>
                        <div id="presentation-well" class="well hidden">
                            <h4 id="presentation-heading">Presentation <small>Beta</small></h4>
                            <span>
                                    <div class="pull-right">
                                        <span id="pres-position">Slide: <span id="current-slide-num">0</span> of <span class="presentation-current-slide-count">0</span></span>
                                        <a id="presentation-settings-button" class="btn btn-xs btn-default" data-toggle="tooltip" data-placement="bottom" data-container="body" title="Presentation Settings"><i class="fa fa-sliders"></i></a>
                                        <a id="presentation-fullscreen-button" class="btn btn-xs btn-default" data-toggle="tooltip" data-placement="bottom" data-container="body" title="Presentation Full Screen"><i class="fa fa-play"></i></a>
                                        <a class="btn btn-xs btn-default disabled"><i class="fa fa-share-alt"></i></a>
                                    </div>
                            </span>
                            <div id="presentation-settings">
                                <div>
                                    <i class="fa fa-hand-o-right"></i> Generated <span class="presentation-current-slide-count">0</span> of <span class="presentation-slide-count">15</span> requested slides with
                                    <span id="presentation-bullet-count">
                                        <span id="presentation-slider-bullet-min"></span> to <span id="presentation-slider-bullet-max"></span> bullets per slide.
                                    </span>
                                </div>

                                <div>
                                    <div id="presentation-settings-slides" class="row">
                                        <div class="col-sm-1">Slides</div>
                                        <div id="presentation-slider" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all col-sm-10">
                                            <span id="presentation-slider-handle" class="slider-handle ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 20%;"></span>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-sm-1">Bullets</div>
                                        <div id="presentation-slider-bullet" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all col-sm-10">
                                            <div id="presentation-slider-bullet-progress"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="document_text">
                            <div class="tab-content dvs-tab dvs-anno-margin" id="document_tab_content">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="pvs" class="row">
        <!-- PVs -->
        <div id="properties_view" class="tabbable tabs-below">
            <div>
                <div id="pvs-tabs-content" class="tab-content">

                    <!-- PHRASING TAB -->
                    <div class="tab-pane active" id="pvs_phrasing_tab">

                        <div class="row">
                            <!-- Phrasings list -->
                            <div class="col-xs-7 pvs-properties">
                                <div id="pvs-phrasing-list-panel" class="panel panel-info pvs-panel">
                                    <div class="panel-heading pvs-panel-heading">
                                        <h5 class="panel-title">Phrasings</h5>
                                    </div>
                                    <div class="panel-body pvs-panel-body pvs-scroll">
                                        <table id="pvs_phrasing_table" class="table table-striped table-condensed">
                                            <tbody>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <!-- Phrasing metadata -->
                            <div id="pvs-phrasing-properties" class="col-xs-5 pvs-properties">
                                <div id="pvs-phrasing-properties-panel" class="panel panel-info pvs-panel">
                                    <div class="panel-heading pvs-panel-heading">
                                        <h5 class="panel-title">Properties</h5>
                                    </div>
                                    <div class="panel-body pvs-panel-body pvs-scroll">
                                        <table class="table table-striped table-condensed">
                                            <tbody id="phr_prop_body">
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- CONCEPT TAB -->
                    <div class="tab-pane" id="pvs_concept_tab">
                        <div class="row">
                            <!-- Concept properties -->
                            <div id="pvs-concept-properties" class="col-xs-12 pvs-properties">
                                <div id="pvs-concept-properties-panel" class="panel panel-info pvs-panel">
                                    <div class="panel-heading pvs-panel-heading">
                                        <h5 class="panel-title">Properties</h5>
                                    </div>
                                    <div class="panel-body pvs-panel-body pvs-scroll">
                                        <table class="table table-striped table-condensed">
                                            <tbody id="con_prop_body">
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- DOCUMENT TAB -->
                    <div class="tab-pane" id="pvs_document_tab">
                        <div class="row">
                            <!-- Document properties -->
                            <div id="pvs-document-properties" class="col-xs-12 pvs-properties">
                                <div id="pvs-document-properties-panel" class="panel panel-info pvs-panel">
                                    <div class="panel-heading pvs-panel-heading">
                                        <h5 class="panel-title">Properties</h5>
                                    </div>
                                    <div class="panel-body pvs-panel-body pvs-scroll">
                                        <table class="table table-striped table-condensed">
                                            <tbody id="doc_prop_body">
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- COLLABORATION TAB -->
                    <div class="tab-pane" id="pvs_collaboration_tab">
                        <div class="row">
                            <div id="pvs-collaboration-users" class="col-xs-4 pvs-properties">
                                <div id="pvs-collaboration-panel" class="panel panel-info pvs-panel">
                                    <div class="panel-heading pvs-panel-heading">
                                        <h5 class="panel-title">Users</h5>
                                    </div>
                                    <div class="panel-body pvs-panel-body pvs-scroll">
                                        <table class="table table-condensed">
                                            <tbody id="col_user_tb_body">
                                                <tr>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <!-- Document properties -->
                            <div id="pvs-document-properties" class="col-xs-8 pvs-properties">
                                <div id="pvs-document-properties-panel" class="panel panel-info pvs-panel">
                                    <div class="panel-heading pvs-panel-heading">
                                        <h5 class="panel-title">Chat</h5>
                                    </div>
                                    <div id="chat_panel" class="panel-body pvs-panel-body">
                                        <!-- see here: http://www.bootply.com/RMQctuZqHJ -->
                                        <div id="doc_chat" class="chat doc_chat">
                                            <div id="doc_chat_view" class="chat doc_chat_view">
                                                <table id="chat-table" class="table table-striped table-condensed ">
                                                    <tbody id="chat_messages" class="chat_messages"></tbody>
                                                </table>
                                            </div>
                                            <div id="doc_chat_input" class="chat chat_input">
                                                <div class="input-group">
                                                    <input id="grp_chat_input" type="text" class="form-control">
                                                    <span class="input-group-btn">
                                                        <button id="grp_chat_input_send" class="btn btn-primary" type="button"><i class="fa fa-send"></i></button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- COMMENTS TAB -->
                    <div class="tab-pane" id="pvs_comments_tab" data-toggle="pill">
                        <div class="row">
                            <!-- Annotation list -->
                            <div class="col-xs-6 pvs-properties pvs-annotations">
                                <div id="pvs-annos-list-panel" class="panel panel-info pvs-panel">
                                    <div class="panel-heading clearfix pvs-panel-heading">
                                        <h5 class="panel-title pull-left">Comments</h5>
                                        <button href="#" id="crt_new_anno_btn" class="anno-act-btn btn btn-primary btn-xs pull-right"><i class="fa fa-plus"></i></button>
                                    </div>
                                    <div id="anno_panel" class="panel-body pvs-panel-body pvs-scroll">
                                        <table id="pvs_annos_table" class="table table-condensed">
                                            <tbody id="pvs_annos_table_body">
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <!-- Comment thread -->
                            <div class="col-xs-6 pvs-properties pvs-thread">
                                <div id="pvs-thread-list-panel" class="panel panel-info pvs-panel">
                                    <div class="panel-heading pvs-panel-heading">
                                        <h5 class="panel-title">Thread</h5>
                                    </div>
                                    <div class="panel-body pvs-panel-body">
                                        <div id="comment-view">
                                            <table id="pvs_comments_table" class="table table-striped table-condensed">
                                                <tbody id="pvs_comments_table_body">
                                                </tbody>
                                            </table>
                                        </div>
                                        <div id="comment_input_div" class="chat_input">
                                            <div class="input-group">
                                                <input id="comment_input" type="text" class="form-control" >
                                                <span class="input-group-btn">
                                                    <button id="comment_input_send" class="btn btn-primary" type="button"><i class="fa fa-reply"></i></button>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SEARCH TAB -->
                    <div class="tab-pane" id="pvs_search_tab" data-toggle="pill">
                        <div class="row">
                            <span class="col-lg-12">
                                <div id="pvs-search-results" class="search_phrasing_table">
                                    <div id="searching-message" class="alert alert-info searching-message text-center">Searching Please Wait <i class="fa fa-spinner fa-spin"></i></div>
                                    <div id="no-results-message" class="alert alert-warning no-results-message text-center">No Results</div>
                                    <table id="project_table" class="table table-striped table-hover table-condensed">
                                        <tbody id="search_phrasing_table_body"></tbody>
                                    </table>
                                </div>
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <ul class="nav nav-tabs pvs-tabs">
            <li><a id="document_pvs_tab" data-target="#pvs_document_tab" data-toggle="tab" class="pvs-tab" data-toggle="tooltip" title="Document Properties"><i class="fa fa-fw fa-folder-open-o"></i> </a></li>
            <li><a id="concept_pvs_tab" data-target="#pvs_concept_tab" data-toggle="tab" class="pvs-tab" data-toggle="tooltip" title="Concept Properties"><i class="fa fa-fw fa-file-o"></i> </a></li>
            <li class="active"><a id="phrasing_pvs_tab" data-target="#pvs_phrasing_tab" data-toggle="tab" class="pvs-tab" data-toggle="tooltip" title="Phrasing Properties"><i class="fa fa-fw fa-file-text-o"></i> </a></li>
            <li><a id="collaboration_pvs_tab" data-target="#pvs_collaboration_tab" data-toggle="tab" class="pvs-tab" data-toggle="tooltip" title="Collaboration Panel"><i class="fa fa-fw fa-users"></i><span id="coll_count_badge" class="badge animated">0</span></a></li>
            <li id="comments_pvs_tab"><a id="comments_pvs_tab" data-target="#pvs_comments_tab" data-toggle="tab" class="pvs-tab"><i class="fa fa-fw fa-comments" data-toggle="tooltip" title="Comments"></i></a></li>
            <li id="search_pvs_tab" class="hidden"><a id="search_pvs_tab" data-target="#pvs_search_tab" data-toggle="tab" class="pvs-tab"><i class="fa fa-fw fa-search" data-toggle="tooltip" title="Search Results"></i></a></li>

            <div id="pvs-status">
                <span id="edit-mode" class="label label-primary">Edit Mode</span>
                <span id="sync-status"><i class="fa fa-cloud synchronized"></i></span>
                <button id="pvs-toggle" class="btn btn-xs btn-default" data-toggle="tooltip" title="Show/Hide Properties View"><i class="fa fa-expand"></i></button>
            </div>
        </ul>

        </div>
    </div>
</div>

<!-- Modals -->
{% include 'modals/project_create.html' %}
{% include 'modals/project_restore.html' %}
{% include 'modals/permission_settings.html' %}
{% include 'modals/concept_create.html' %}
{% include 'modals/document_properties.html' %}
{% include 'modals/keybindings.html' %}
{% include 'modals/concept_share_url.html' %}
{% include 'modals/document_share_url.html' %}
{% include 'modals/summary.html' %}
{% include 'modals/presentation_gen.html' %}
{% include 'modals/publish.html' %}

<!-- Scripts -->
{% include 'bootstrap_modal.html' %}
{% include 'scripts.html' %}
{% include 'project_scripts.html' %}
<script type="text/javascript">
    var server_data;
    function set_server_data(data) {
        server_data = data;
    }
    set_server_data({{ data|safe }});

    function initialize(server_data) {
        Page.initialize(server_data);
        console.debug(server_data);

        Shortcut.initialize();
        ProjectSearch.initialize();

        var user = new User();
        user.initCurrentUser(server_data.user);
        var project = new Project();
        project.initProject(server_data.project, server_data.loader_configs, true);

        Page.sendAnalytics();
        NavigationBar.initialize();
        Shortcut.set('dvs');
        Project.setupPage(null, server_data.act_con_path);
        PVS.initialize();
        if (server_data.context_menu)
            load_context_menu();
        DVS.resizeDVS();

        if (!get_user().tour_project_complete)
            show_guided_tour_offering();

        if (server_data.open_chal) {
            Channel.initialize(user);
            CollaborationTable.initialize();
            DocumentChat.initialize();
        }

        new ClipboardJS('.copy-btn');
    }

    $(window).resize(function () {
        DVS.resizeDVS();
    });

    window.onerror = function (message, url, line) {
        console.error('Error:', '\nmessage: ', message, '\nurl: ', url, '\nline: ', line);
        if (Page.getDebugLevel() >= 4) {
            alert('There was an error, please check your console for logs');
        }
    };

    window.onbeforeunload = function () {
        if (!_synced)
            return 'Still syncing changes to server';
        return null;
    };

    window.onload = function () {
        initialize(server_data);
    };
</script>
</body>
</html>
