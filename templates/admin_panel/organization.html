<div class="row">
    <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
        <h1 class="page-title txt-color-blueDark">
            <i class="fa fa-university "></i>
            {% if not org %}Organizations{% else %}Organization{% endif %}
        </h1>
    </div>
</div>

<!-- widget grid -->
<section id="widget-grid" class="">

<!-- row -->
<div class="row">

{% if not org %}
<!-- NEW WIDGET START -->
<article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

<!-- Widget ID (each widget will need unique ID)-->
<div class="jarviswidget jarviswidget-color-blueDark" id="org_table" data-widget-editbutton="false">
<!-- widget options:
                usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">

                data-widget-colorbutton="false"
                data-widget-editbutton="false"
                data-widget-togglebutton="false"
                data-widget-deletebutton="false"
                data-widget-fullscreenbutton="false"
                data-widget-custombutton="false"
                data-widget-collapsed="true"
                data-widget-sortable="false"

                -->
<header>
    <span class="widget-icon"> <i class="fa fa-university"></i> </span>
    <h2>Organizations</h2>

</header>

<!-- widget div-->
<div>

<!-- widget edit box -->
<div class="jarviswidget-editbox">
    <!-- This area used as dropdown edit box -->

</div>
<!-- end widget edit box -->

<!-- widget content -->
<div class="widget-body no-padding">
    <div id="org_action_div" class="org_action_div">
        <div class="btn-group org_action_btn">
            <button class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                Action
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
                <li title="Add New Organization"><a id="add_org_btn" href="javascript:void(0);">Add</a></li>
{#                <li title="Delete Organization"><a id="delete_org_btn" href="javascript:void(0);">Delete</a></li>#}
            </ul>
        </div>
    </div>
    <table id="organization_table" class="table table-striped table-hover">
        <thead>
            <tr>
                <th>Login</th>
                <th>ID</th>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Domain</th>
                <th>Website</th>
                <th>Created Date</th>
            </tr>
        </thead>
        <tbody id="user_tb_body">
        </tbody>
        <tfoot>
        <tr>
            <th>Login</th>
            <th>ID</th>
            <th>Name</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Domain</th>
            <th>Website</th>
            <th>Created Date</th>
        </tr>
        </tfoot>
    </table>

</div>
<!-- end widget content -->

</div>
<!-- end widget div -->

</div>
<!-- end widget -->

</article>
<!-- WIDGET END -->

{% endif %}

</div>
<!-- end row -->

</section>
<!-- end widget grid -->

<!-- Modal -->
<div class="modal fade" id="new_org_modal" tabindex="-1" role="dialog" aria-labelledby="new_org_modal_label" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="myModalLabel">New Org</h4>
            </div>
            <div class="modal-body">
                <form action="" id="new_org_form" class="smart-form" novalidate="novalidate">
                    <fieldset>
                        <div class="row">
                            <section class="col col-6">
                                <label class="label">ID (no whitespace)</label>
                                <label class="input"><i class="icon-append fa fa-asterisk"></i>
                                    <input type="text" id="new_org_id" name="id">
                                </label>
                            </section>
                            <section class="col col-6">
                                <label class="label">Name</label>
                                <label class="input"><i class="icon-append fa fa-asterisk"></i>
                                    <input type="text" name="name">
                                </label>
                            </section>
                        </div>
                        <div class="row">
                            <section class="col col-6">
                                <label class="label">Account Type</label>
                                <label class="input">
                                    <input type="text" name="account_type">
                                </label>
                            </section>
                            <section class="col col-6">
                                <label class="label">Point of contact</label>
                                <label class="input">
                                    <input type="text" name="point_of_contact">
                                </label>
                            </section>
                        </div>
                        <div class="row">
                            <section class="col col-6">
                                <label class="label">Domain</label>
                                <label class="input">
                                    <input type="text" name="domain">
                                </label>
                            </section>
                            <section class="col col-6">
                                <label class="label">Webpage</label>
                                <label class="input">
                                    <input type="text" name="webpage">
                                </label>
                            </section>
                        </div>
                        <div class="row">
                            <section class="col col-6">
                                <label class="label">Owner</label>
                                <label class="input">
                                    <input type="text" name="owner">
                                </label>
                            </section>
                            <section class="col col-6">
                                <label class="label">Email</label>
                                <label class="input">
                                    <input type="text" name="email">
                                </label>
                            </section>
                        </div>
                        <div class="row">
                            <section class="col col-6">
                                <label class="label">Phone Number</label>
                                <label class="input">
                                    <input type="text" name="phone">
                                </label>
                            </section>
                            <section class="col col-6">
                                <label class="label">Fax</label>
                                <label class="input">
                                    <input type="text" name="fax">
                                </label>
                            </section>
                        </div>
                        <section>
                            <label class="label">Description</label>
                            <label class="input">
                                <input type="text" name="description">
                            </label>
                        </section>
                        <div class="note">
                            Fields marked with <i class="fa fa-asterisk"></i> are required
                        </div>
                    </fieldset>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">
                    Cancel
                </button>
                <button type="submit" class="btn btn-primary" form="new_org_form">
                    Create
                </button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<script type="text/javascript">

    // DO NOT REMOVE : GLOBAL FUNCTIONS!
    pageSetUp();

    // PAGE RELATED SCRIPTS

    /* remove previous elems */

    if($('.DTTT_dropdown.dropdown-menu').length){
        $('.DTTT_dropdown.dropdown-menu').remove();
    }

    loadDataTableScripts();
    function loadDataTableScripts() {
        loadScript("/lib/plugin/datatables/jquery.dataTables.min.js", function(){
            loadScript("/lib/plugin/datatables/dataTables.colVis.min.js", function(){
                loadScript("/lib/plugin/datatables/dataTables.tableTools.min.js", function(){
                    loadScript("/lib/plugin/datatables/dataTables.bootstrap.min.js", function () {
                        loadScript("/lib/plugin/select2/select2.min.js", function () {
                            loadScript("/lib/typehead/typeahead.js", runDataTables);
                        });
                    });
                });
            });
        });
    }

    function runDataTables() {
        /* Add the events etc before DataTables hides a column */
        $("#datatable_fixed_column thead input").keyup(function() {
            oTable.fnFilter(this.value, oTable.oApi._fnVisibleToColumnIndex(oTable.fnSettings(), $("thead input").index(this)));
        });

        $("#datatable_fixed_column thead input").each(function(i) {
            this.initVal = this.value;
        });
        $("#datatable_fixed_column thead input").focus(function() {
            if (this.className == "search_init") {
                this.className = "";
                this.value = "";
            }
        });
        $("#datatable_fixed_column thead input").blur(function(i) {
            if (this.value == "") {
                this.className = "search_init";
                this.value = this.initVal;
            }
        });

        function org_load_cb () {
            initialize_org_table();
            var new_org_modal = $('#new_org_modal');
            new_org_modal.modal({show: false});
            new_org_modal.on('shown.bs.modal', function() {
                $('#new_org_id').focus();
            });
            $('#add_org_btn').click(function () {
                new_org_modal.modal('show');
            });
        }

        loadScript("/js/admin/organization_su.js", org_load_cb);
    }

</script>
